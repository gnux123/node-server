<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script src="https://code.jquery.com/jquery-git2.min.js" charset="utf-8"></script>
		<script>
			$(function(){
				var data = {
					apiUri: "http://localhost:3000",
					getData: function(objUri){
						$.ajax({
							url: objUri+"/Home/GetLeftMenu",
							dataType: "json",
						    success: function(data) {
								output(data);
						    },
							error: function(xhr, ajaxOptions, thrownError) {
						      alert("load errors");
						    }
						});

						function output(content){
							data.menuProcess(content);
							data.effects();
						}

					},
					//資料綁定
					menuProcess: function(jdata){
						$(".toolbar").append("<label class='mainMenu--Btn' for='mainMenuBtn'>MenuBtn</label><input id='mainMenuBtn' type='checkbox' hidden><ul class='mainMenu'></ul>");

						$.each(jdata, function(key,value){
							var _cateName = jdata[key].catesName,
								_link = jdata[key].cateslink,
								subCates = jdata[key].subCates;
							//http://www.newegg.com.tw"+_link+"
							$(".mainMenu").append("<li><a href='javascript:void(0);'>"+_cateName+"</a></li>");
							$(".container").append("<div class='subMenu'></div>");


							$.each(subCates, function(index,value){
								var subName = subCates[index][0].secName;
								var adImg = subCates[index][0].ImgAD;
								var adImgLink = subCates[index][0].ImgADLink;
								var secMenus = $(".subMenu").eq(key);

								if(adImg == undefined && adImgLink == undefined){
									secMenus.append("<div><h4>"+subName+"</h4>\
									<div class='thirdCates'></div>\
									</div>");
								}else{
									secMenus.append("<div><h4>"+subName+"</h4>\
									<a href='http://www.newegg.com.tw"+adImgLink+"'><img src='"+adImg+"' /></a>\
									<div class='thirdCates'></div>\
									</div>");
								}
								childCates();

								//第三層
								function childCates(){
									var childCates = subCates[index][0].thirdCates;
									for(i = 0; i < childCates.length; i++){
										secMenus.children("div").eq(index).find(".thirdCates").append("<p><a href='http://www.newegg.com.tw"+childCates[i].link+"'>"+childCates[i].desc+"</a></p>");

									}
								}

							});

						});
					},
					//效果設計
					effects: function(){
						$(".subMenu").hide();
						$(".mainMenu").click(function(){
							$("#mainMenuBtn[type='checkbox']").attr("checked",false);
						});

						$(".subMenu").eq(0).show();

						$(".mainMenu").find("li").each(function(index){
							$(this).click(function(){
								$(".subMenu").eq(index).fadeIn().siblings(".subMenu").hide();
							});
						});
					}
				};

				data.getData(data.apiUri);

			});

		</script>
		<style>
			.mainMenu {
				display:none;
				position: fixed;
				z-index: 95;
				top:0;
				left:0;
				width: 100%;
				height: 100%;
				margin:0;
				padding:0;
				clear: both;

				list-style: none;
				background: rgba(0,0,0,.5);

			}

			#mainMenuBtn[type='checkbox']:checked ~.mainMenu { display: block; }

			.mainMenu > li {
				float:left;
				display: inline-block;
				width: 33.3%;
				height: auto;
			}

			.mainMenu--Btn {
				position: relative;
				z-index: 99;
			}

			.mainMenu > li > a {
				display: block;
				width: 100%;
				height: 100%;

				text-align: center;
				line-height: 50px;
				text-decoration: none;
				color: #fff;
				font-size: 33px;
			}

		</style>
	</head>
	<body>
		<div class="container">
			<div class="toolbar">
			</div>
		</div>

	</body>
</html>
